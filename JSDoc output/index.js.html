<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const URL = "https://api.genderize.io/";


/**
 * show message in alert-container
 * @param message {string}
 * @param messageType {string}
 * @param timeout {number}
 */
let showMessage = (message, messageType, timeout) => {
    let alert = document.getElementById('alert');
    messageType === "Error" ? alert.style.color = "red" : alert.style.color = "green"
    alert.style.fontSize = "x-large";
    alert.style.opacity = 1;
    alert.innerHTML = message;
    setTimeout(() => {
        alert.style.opacity = 0;
    }, timeout);
}


/**
 * send request to URL (https://api.genderize.io/) with param name
 * get json response
 * @param name {string}
 * @returns {Promise&lt;Response>}
 */
let sendRequest = async (name) => {
    try {
        let res = await fetch(URL + `?name=${name}`);
        return res.json()
    }
    catch (err){
        showMessage(err, "Error", 4000)
    }

}


/**
 * get information about name (gender and probability)
 * then set in document HTML
 * @param nameInfo {Object}
 */
let setPrediction = (nameInfo) => {
    let {name, gender, probability} = nameInfo;
    if (gender) {
        document.getElementById("response-gender").innerHTML = `Gender: ${gender}`;
        document.getElementById("response-prob").innerHTML = `Prob: ${probability}`;
        gender === "male" ? document.getElementById("male-button").checked = true
            : document.getElementById("female-button").checked = true
    }
    else
        showMessage(`This name (${name}) doesn't exist!!!`, "Error", 4000)
}



/**
 * show saved answer in the right bottom of page
 * check local storage, if name exists => show gender
 * else => show nothing
 * @param name {string}
 */
let showSavedAnswer = (name) => {
    let resFromLocalStorage = getNameInfoFromLocalStorage(name);
    if (resFromLocalStorage.gender)
        document.getElementById('saved-answer-gender').innerHTML = resFromLocalStorage.gender;
    else
        document.getElementById('saved-answer-gender').innerHTML = "Nothing!";
}


/**
 * @returns name {string}
 */
let getNameFromInput = () => {
    return document.getElementById("input-name").value;
}


/**
 * check name with regex and length
 * @param name {string}
 */
let checkRuleForName = (name) => {
    if (!/^[a-zA-Z\s]*$/.test(name) === true)
        throw Error(`input name(${name}) has bad character. change it.`)
    if (name.length > 255)
        throw Error(`input name(${name}) length is more than 255 character. change it.`)
}


/**
 * send request to URL and get response
 * then set prediction
 */
let handleRequest = async () => {
    try{
        let inputName = getNameFromInput()
        checkRuleForName(inputName)
        let message = `Fetching information about name: ${inputName}`
        showMessage(message, "Notice", 2000);
        let nameInfo = await sendRequest(inputName);
        setPrediction(nameInfo);
        showSavedAnswer(inputName)
    }
    catch (err) {
        showMessage(err, "Error", 4000)
    }
}


/**
 * when click on submit => call handle request
 * @param event
 * @returns {Promise&lt;void>}
 */
let onSubmit = async (event) => {
    event.preventDefault();
    await handleRequest();
}


/**
 * get name and then search in local storage
 * if name exist in local storage => return {name, gender}
 * else => return {name, null}
 * @param name {string}
 * @returns nameInfo {Object}
 */
let getNameInfoFromLocalStorage = (name) => {
    let nameInfo = {name, gender: localStorage.getItem(name)}
    return nameInfo
}


/**
 * remove name and gender from local storage
 * @param name {string}
 */
let deleteNameInfoFromLocalStorage = (name) => {
    let resFromLocalStorage = getNameInfoFromLocalStorage(name);
    if (resFromLocalStorage.gender) {
        localStorage.removeItem(name)
        return true
    }
}


/**
 * save name and gender to local storage
 * @param nameInfo {Object}: {name: string, gender: string}
 */
let saveNameInfo = (nameInfo) => {
    let {name, gender} = nameInfo
    localStorage.setItem(name, gender)
}


/**
 * when click on save button => get nameInfo and save in local storage (saveNameInfo)
 * then show message in alert container
 * then show saved answer
 * @param event
 */
let onSave = (event) => {
    event.preventDefault();
    let gender = document.querySelector('input[name="gender"]:checked').value;
    let name = getNameFromInput();
    saveNameInfo({name, gender});
    let message = `Saved name: ${name}, gender: ${gender}.`
    showMessage(message, "Notices", 4000)
    showSavedAnswer(name)

}

/**
 * when click on clear button => get name and delete name from local storage (deleteNameInfoFromLocalStorage)
 * then show saved answer
 * @param event
 */
let onClear = (event) => {
    event.preventDefault();
    let name = getNameFromInput();
    let message = `Deleted name: ${name} from local storage.`
    deleteNameInfoFromLocalStorage(name) ? showMessage(message, "Notices", 4000):
    showMessage("Nothing to delete!!!", "Error", 4000);
    showSavedAnswer(name);
}





// document.getElementById('submit').onclick = onSubmit
// document.getElementById('save').onclick = saveMyAnswer</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#checkRuleForName">checkRuleForName</a></li><li><a href="global.html#deleteNameInfoFromLocalStorage">deleteNameInfoFromLocalStorage</a></li><li><a href="global.html#getNameFromInput">getNameFromInput</a></li><li><a href="global.html#getNameInfoFromLocalStorage">getNameInfoFromLocalStorage</a></li><li><a href="global.html#handleRequest">handleRequest</a></li><li><a href="global.html#onClear">onClear</a></li><li><a href="global.html#onSave">onSave</a></li><li><a href="global.html#onSubmit">onSubmit</a></li><li><a href="global.html#saveNameInfo">saveNameInfo</a></li><li><a href="global.html#sendRequest">sendRequest</a></li><li><a href="global.html#setPrediction">setPrediction</a></li><li><a href="global.html#showMessage">showMessage</a></li><li><a href="global.html#showSavedAnswer">showSavedAnswer</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Fri Dec 03 2021 03:02:33 GMT+0330 (Iran Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
